<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wonjoejo.myapp.mapper.GroupMapper">

	<!--그룹원 목록  -->
	<select id="selectGroupMemberList" resultType="com.wonjoejo.myapp.domain.MemberVO">
		<![CDATA[
		
			 SELECT member.member_id, MEMBER.NAME, MEMBER.PHONE_NUMBER
 			 FROM MEMBER, BOX
			 WHERE BOX.MEMBER_ID = MEMBER.MEMBER_ID AND BOX_NO = #{BOX_NO}
 
		]]>	
	
	</select>
	
	<!--그룹원 권한 조회  -->
	
		<select id="selectGroupPermissionList" resultType="com.wonjoejo.myapp.domain.BoxPermissionVO">
		<![CDATA[
		
			 SELECT 
			 *
			 FROM BOX_PERMISSION
			 WHERE BOX_NO = #{BOX_NO}
		]]>	
	
	</select>

	<!--그룹 가입-->
	<insert id="insertMember"> 
		 <selectKey keyProperty="no" resultType="int" order="BEFORE">
            SELECT NO_SEQ.nextval FROM DUAL
        </selectKey>
	
		INSERT INTO BOX_PERMISSION(NO, BOX_NO, MEMBER_ID, MASTER_PER, WRITE_PER, READ_PER, EDIT_PER, DELETE_PER,MEMBER_STAT)
		VALUES (#{no}, #{box_no}, #{member_id}, #{master_per}, #{write_per}, #{read_per}, #{edit_per}, #{delete_per}, #{member_stat})
		
	</insert>


	<!--그룹 권한 변경-->
	<update id="updateMember">
		UPDATE BOX_PERMISSION
		MEMBER_ID = #{MEMBER_ID},
		MASTER_PER = #{MASTER_PER},
		WRITE_PER = #{WRITE_PER},
		READ_PER = #{READ_PER},
		EDIT_PER = #{EDIT_PER},
		DELETE_PER = #{DELETE_PER}
		WHERE BOX_NO = #{box_no}	
	</update>	
	
	
	
	
	<!-- 그룹 탈퇴 -->
	<update id="deleteMember">
		UPDATE BOX_PERMISSION
		MEMBER_STAT= #{MEMBER_STAT}
		WHERE MAMBER_ID = #{member_id}
	</update>





</mapper>